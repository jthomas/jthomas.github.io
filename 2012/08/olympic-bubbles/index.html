<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.69.2" />

    
    
    

<title>Olympic Bubbles • notes on software.</title>
<meta name="description" content="James Thomas&#39; blog about software. Posts about serverless, cloud platforms, openwhisk, node.js and more...">
<meta name="keywords" content="blog,serverless,openwhisk,ibm,nodejs,tensorflow,serverless framework,open-source,conferences,developer advocacy,github">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Olympic Bubbles"/>
<meta name="twitter:description" content="Discover how to use Dojo&#39;s build system, with static feature configuration flags, to produce an AMD loader that fits in just four kilobytes."/>

<meta property="og:title" content="Olympic Bubbles" />
<meta property="og:description" content="Discover how to use Dojo&#39;s build system, with static feature configuration flags, to produce an AMD loader that fits in just four kilobytes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jamesthom.as/2012/08/olympic-bubbles/" />
<meta property="article:published_time" content="2012-08-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2012-08-08T00:00:00+00:00" />


    






<link rel="stylesheet" href="/scss/hyde-hyde.3081c4981fb69a2783dd36ecfdd0e6ba7a158d4cbfdd290ebce8f78ba0469fc6.css" integrity="sha256-MIHEmB&#43;2mieD3Tbs/dDmunoVjUy/3SkOvOj3i6BGn8Y=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    <style type="text/css">
.content {
  max-width: 48rem;
}

.sidebar .container {
  padding-right: 0rem;
  padding-left: 0rem;
}

h1 {
  margin-top: 0;
}
</style>

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://jamesthom.as">notes on software.</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://jamesthom.asprofile.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         by james thomas serverless aficionado. 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">notes on software.</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/thomasj" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/jthomas" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	<a href="https://stackoverflow.com/users/1427084" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://medium.com/@jamesthom.as" rel="me"><i class="fab fa-medium fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
        
	<a href="https://www.youtube.com/user/jthomasuk" rel="me"><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="mailto:blog@jamesthom.as" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Olympic Bubbles</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Aug 08, 2012
    
    
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/datasift">datasift</a>
           
      
          <a class="badge badge-tag" href="/tags/javascript">javascript</a>
           
      
          <a class="badge badge-tag" href="/tags/olympics">olympics</a>
           
      
          <a class="badge badge-tag" href="/tags/visualisation">visualisation</a>
          
      
    
    
    <br/>
    
    <i class="fas fa-clock"></i> 7 min read
    
</div>


  </header>
  
  
  <div class="post">
    <p>Introducing <strong>Olympic Bubbles</strong>, an experiment visualising mentions of the
London 2012 Olympics sports on Twitter in real-time.</p>
<p><img src="/images/olympic_bubbles.png" alt=""></p>
<p>With the London 2012 Olympics having multiple events running concurrently, Twitter&rsquo;s become invaluable
for catching up on the day&rsquo;s action, deciding what to watch and getting real-time insight into current events.</p>
<p>Having recently started to play with a JavaScript visualisation library (<a href="http://d3js.org/">D3</a>), this seemed like a great opportunity
to connect the two activities and automate the analysis of Twitter to visualise the most talked about Olympic sports.</p>
<p>Before we can visualise the data, we needed a way to filter the Twitter firehose for tweets mentioning the Olympic games&hellip;</p>
<h2 id="analysing-tweets-for-olympic-sports">Analysing tweets for Olympic sports</h2>
<p>Twitter provides a <a href="https://dev.twitter.com/docs/streaming-apis/streams/public">public API</a> for filtering their
stream, based on keyword matching, but there are two issues with this service:</p>
<ul>
<li><strong>No access to the firehose.</strong> Results don&rsquo;t represent the full set of matches from the Twitter &ldquo;firehose&rdquo;, only a sample are returned.</li>
<li><strong>Polling, not real-time.</strong> No support for receiving results in real-time, the client has to manually poll for new results over HTTP.</li>
</ul>
<p>These problems made Twitter&rsquo;s API unsuitable and an alternative was needed&hellip;</p>
<p>Enter <a href="http://datasift.com">DataSift.</a></p>
<blockquote>
<p>DataSift is a real-time media curation platform, allowing you to mine the
Twitter Firehose for tweets matching the specific criteria of your choice.
DataSift&rsquo;s custom Curation Stream Definition Language allows you to filter
based on any meta data within a tweet</p>
</blockquote>
<p>DataSift are one of only two companies with unrestricted access to the Twitter &ldquo;firehose&rdquo;. They provide a free
trial account, with enough credit to mine 10,000 tweets.</p>
<h3 id="write-a-custom-stream-filter">Write a custom stream filter</h3>
<p>DataSift provides a custom query language, <a href="http://dev.datasift.com/csdl">CSDL (Curated Stream Definition Language)</a>,
for defining stream filters that can match messages based upon text, location, users and much more.</p>
<p>Defining a new filter, we&rsquo;re interested in all messages that contain references to the London 2012 Olympics along with a sport.
Matching all tweets containing key words can be performed using the <em>contains</em> <a href="http://dev.datasift.com/docs/operators">operator</a>
on the <em>content</em> <a href="http://dev.datasift.com/docs/targets/common-interaction">property</a> of the <em>interaction</em> <a href="http://dev.datasift.com/docs/targets/common-interaction">instance</a>.
Each <em>interaction</em> represents a single tweet from the Twitter Firehose.</p>
<p>The example below shows how to match any tweets which mention the word
<strong>olympic</strong> but ignore those without a valid sport, using the
<em>conjunction</em> and <em>contains_any</em> operator to make sure those matched messages
also contain one of the pre-defined keywords for the sports.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">content</span> <span style="color:#a6e22e">contains</span> <span style="color:#e6db74">&#34;olympic&#34;</span>
<span style="color:#a6e22e">AND</span> 
<span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">content</span> <span style="color:#a6e22e">contains_any</span> <span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">    Archery,
</span><span style="color:#e6db74">    Athletics,
</span><span style="color:#e6db74">    Badminton,
</span><span style="color:#e6db74">    ...
</span><span style="color:#e6db74">    Volleyball,
</span><span style="color:#e6db74">    Water Polo,
</span><span style="color:#e6db74">    Weightlifting,
</span><span style="color:#e6db74">    Wrestling&#34;</span>
</code></pre></div><p>Looking over the CSDL documentation, there was a feature that allowed user generated
<a href="http://dev.datasift.com/docs/advanced/tag-keyword">tags</a> to be appended to filtered messages.
Rather than having the client-side code manually
parse each message to determine which sports were referenced, we can append a tag during
the filtering process, as shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">tag</span> <span style="color:#e6db74">&#34;archery&#34;</span> {
  <span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">content</span> <span style="color:#a6e22e">contains</span> <span style="color:#e6db74">&#34;archery&#34;</span>
}

<span style="color:#a6e22e">tag</span> <span style="color:#e6db74">&#34;athletics&#34;</span> {
  <span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">content</span> <span style="color:#a6e22e">contains</span> <span style="color:#e6db74">&#34;athletics&#34;</span>
}

<span style="color:#a6e22e">tag</span> <span style="color:#e6db74">&#34;badminton&#34;</span> {
  <span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">content</span> <span style="color:#a6e22e">contains</span> <span style="color:#e6db74">&#34;badminton&#34;</span>
}
</code></pre></div><p>Once the stream has been defined, making it public allows any user to access the
stream results. You can see the full stream definition and view a preview of the results
<a href="http://datasift.com/stream/27473/olympics-2012#app1-preview">here</a>.</p>
<h3 id="real-time-results">Real-time results</h3>
<p>Now we have a stream defined, we need to access the results in the browser in real-time.
Along with a traditional REST API, DataSift also provides a streaming API using <a href="https://developer.mozilla.org/en-US/docs/WebSockets">WebSockets</a>.
WebSockets provide a <strong>bi-directional channel for messages between a client and server, without having to poll for replies</strong>. Using their streaming endpoint,
we receive messages from our filtered firehose in real-time.</p>
<p>Setting up the connection and monitoring for new messages was extremely simple, as shown below. Each time a new message arrives,
we increment the frequency count for each of the pre-defined sports based on the interaction tag.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ws</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">WebSocket</span>(<span style="color:#e6db74">&#39;ws://websocket.datasift.com/&lt;hash&gt;?username=&lt;username&gt;&amp;api_key=&lt;api_key&gt;&#39;</span>);

<span style="color:#a6e22e">ws</span>.<span style="color:#a6e22e">onmessage</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">evt</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">evt</span>.<span style="color:#a6e22e">data</span>),
        <span style="color:#a6e22e">tags</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">stats</span>.<span style="color:#a6e22e">interaction</span>.<span style="color:#a6e22e">tags</span>;

    <span style="color:#a6e22e">tags</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">tag</span>) {
        <span style="color:#75715e">// now publish notification of new tagged messages...
</span><span style="color:#75715e"></span>    });
}
</code></pre></div><h2 id="visualising-the-tweets">Visualising The Tweets</h2>
<p><em>Now we have the data, how should we visualise the results?</em></p>
<p>There are hundreds of <a href="http://dojotoolkit.org/reference-guide/1.7/dojox/charting.html">different</a>
<a href="http://www.highcharts.com/">charting</a> <a href="http://code.google.com/p/flot/">libraries</a>
for JavaScript but
rather than drawing a static histogram of the sport frequencies, we want to incorporate
the real-time aspect into the visualisation. As new messages are received, the visualisation
should grow and morph, tied to the transitional nature of the data.</p>
<p><a href="http://d3js.org">D3</a> is a JavaScript visualisation library which provides just that capability.</p>
<blockquote>
<p>D3.js is a JavaScript library for manipulating documents based on data, allowing
you to bind arbitrary data to a Document Object Model (DOM), and then apply data-driven transformations to the document.</p>
</blockquote>
<p>Developed by <a href="http://bost.ocks.org/mike/">Mike Bostock</a> of the Stanford Visualisation Group, the library has fantastic
<a href="https://github.com/mbostock/d3/wiki">documentation</a> along with an extensive <a href="https://github.com/mbostock/d3/wiki/Gallery">examples gallery</a>,
which provides a great starting point for developers.</p>
<h3 id="creating-bubbles">Creating Bubbles</h3>
<p>Reviewing the gallery, the <a href="http://mbostock.github.com/d3/ex/bubble.html"><strong>Bubble</strong></a> example seemed like a good starting point.
Each bubble would represent a single sport and the size would be proportional to the frequency of tweets for that sport.</p>
<p><em>Given a list of sports and frequencies, how do we know where to render the nodes and what size they should be?</em></p>
<p>D3 provides a series of algorithms for converting data series into visual layouts, the Bubble example uses
<a href="https://github.com/mbostock/d3/wiki/Pack-Layout">Pack</a>. This layout turns a hierarchical data structure into
<em>&ldquo;enclosure diagrams using containment (nesting) to represent the hierarchy&rdquo;</em>.</p>
<p>Running our data through this function, shown below, produces a series of
position values (coordinate location pairs with radius) to construct
our bubbles from.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sports</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">archery</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
    <span style="color:#a6e22e">athletics</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>,
    <span style="color:#a6e22e">badminton</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>
    ... 
};

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">layout</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">layout</span>.<span style="color:#a6e22e">pack</span>().<span style="color:#a6e22e">sort</span>(<span style="color:#66d9ef">null</span>).<span style="color:#a6e22e">size</span>([<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">width</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">height</span>]);
    <span style="color:#a6e22e">positions</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">layout</span>.<span style="color:#a6e22e">nodes</span>({<span style="color:#a6e22e">children</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">sports</span>)}
</code></pre></div><p>Using the position information, we need to bind these values to appropriate
DOM elements. Following the example code, we&rsquo;re going to render an SVG <a href="https://developer.mozilla.org/en-US/docs/SVG/Element/g">Group</a> node
to contain the <a href="https://developer.mozilla.org/en-US/docs/SVG/Element/circle">Circle</a> element with a
<a href="https://developer.mozilla.org/en-US/docs/SVG/Element/text">Text</a> node (displaying the sport&rsquo;s label). The example
below shows the code needed for this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">vis</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">select</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">node</span>).<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;svg&#34;</span>)
            .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;width&#34;</span>, <span style="color:#a6e22e">width</span>)
            .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;height&#34;</span>, <span style="color:#a6e22e">height</span>);

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">chart</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">vis</span>.<span style="color:#a6e22e">selectAll</span>(<span style="color:#e6db74">&#34;g.node&#34;</span>)
               .<span style="color:#a6e22e">data</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">layout</span>.<span style="color:#a6e22e">nodes</span>(<span style="color:#a6e22e">data</span>))
               .<span style="color:#a6e22e">enter</span>().<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;g&#34;</span>)
               .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;transform&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;translate(&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>; });

<span style="color:#75715e">// Append circle with radius from layout and fill with arbitary colour
</span><span style="color:#75715e"></span><span style="color:#a6e22e">chart</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;circle&#34;</span>)
     .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;r&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">r</span>; })
     .<span style="color:#a6e22e">style</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fill</span>(<span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">key</span>) });

<span style="color:#75715e">// Add text label to bubble. 
</span><span style="color:#75715e"></span><span style="color:#a6e22e">chart</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;text&#34;</span>)
     .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;text-anchor&#34;</span>, <span style="color:#e6db74">&#34;middle&#34;</span>)
     .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;dy&#34;</span>, <span style="color:#e6db74">&#34;.3em&#34;</span>);
</code></pre></div><p>Choosing an arbitrary colour for the bubble uses the <a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales#wiki-category20c">d3.scale.category20c</a> method,
referenced here by <em>fill()</em>, to produce a mapping between our category labels and a series of twenty colours.</p>
<p>The example above is a slightly condensed version of the actual code, ignoring the handling of multi-lined labels and that font-sizes are relative
to the bubble size, due to brevity.</p>
<h3 id="animating-bubbles">Animating Bubbles</h3>
<p><em>What happens when our data changes?</em></p>
<p>As we receive more messages, the relative frequencies of the sports will change and the bubble layout will need updating.
Using D3, we want to visually transition the bubbles to their new positions, watching them grow and shrink in real-time.</p>
<p>Re-calculating the layout simply needs us to re-run the pack algorithm with the updated values, binding the new data
to the existing chart.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">chart</span>.<span style="color:#a6e22e">data</span>(<span style="color:#a6e22e">layout</span>.<span style="color:#a6e22e">nodes</span>({<span style="color:#a6e22e">children</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">sports</span>)}));
</code></pre></div><p>Now, we just need to use the <a href="https://github.com/mbostock/d3/wiki/Transitions"><em>transition</em></a>
method to translate the old properties
to the new values, over a three second period. As we move the parent group node for
each bubble, we need also update the bubble radius and label font size to make them
proportional to the parent.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// Move bubble node to new position
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">trans</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">chart</span>
    .<span style="color:#a6e22e">transition</span>()
    .<span style="color:#a6e22e">duration</span>(<span style="color:#ae81ff">3000</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;transform&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;translate(&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>; })
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;r&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">r</span>; });

<span style="color:#75715e">// ... update circle radius
</span><span style="color:#75715e"></span><span style="color:#a6e22e">trans</span>.<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#34;circle&#34;</span>)
     .<span style="color:#a6e22e">transition</span>()
     .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;r&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">r</span>; });

<span style="color:#75715e">// ... update text size
</span><span style="color:#75715e"></span><span style="color:#a6e22e">trans</span>.<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#34;text&#34;</span>)
     .<span style="color:#a6e22e">transition</span>()
     .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;font-size&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">d</span>) { <span style="color:#66d9ef">return</span> ((<span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">r</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">50</span>)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;em&#34;</span>; });
</code></pre></div><p><strong>&hellip;and that&rsquo;s it!</strong></p>
<p>Each time new messages flow in from the backend, the data values
change, which triggers a new transition. With a real-time stream of new messages
constantly arriving, the visualisation is constantly morphing and changing.</p>
<h2 id="live-demo">Live Demo</h2>
<p>If you want to see this demo in action, there&rsquo;s a hosted version at
<a href="http://datasift.jamesthom.as">http://datasift.jamesthom.as</a>. You&rsquo;ll need to sign up
for a free DataSift account <a href="https://datasift.com/auth/register/">here</a>
and use your authentication credentials to allow us to access the Twitter firehose.</p>
<p>Source code for the demo is available on Github <a href="http://github.com/jthomas/olympic_bubbles">here</a>.</p>
<h2 id="finally">Finally&hellip;</h2>
<p><em>Why Olympic Bubbles?</em></p>
<p>It&rsquo;s a terrible name but as the quote goes&hellip;</p>
<blockquote>
<p>“There are only two hard things in Computer Science: cache invalidation and naming things”.</p>
</blockquote>
<p>&hellip;and writing this demo was easier than coming up with a sensible name!</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2012/08/finding-nano-getting-dojo-under-4kb/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Finding Nano - Getting Dojo under 4KB</span>
    </a>
    
    
    <a href="/2012/10/london-js-watson/" class="navigation-next">
      <span class="navigation-tittle">London JS - Watson</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>
<script data-goatcounter="https://jamesthomas.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>


    
    
    <script type="text/javascript">
        

    </script>
    




    



    </body>
</html>
